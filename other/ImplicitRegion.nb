(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42172,        923]
NotebookOptionsPosition[     38810,        862]
NotebookOutlinePosition[     39236,        879]
CellTagsIndexPosition[     39193,        876]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Using ImplicitRegion rather than Boole", "Section",
 CellChangeTimes->{{3.819034429332972*^9, 3.819034435045079*^9}, {
  3.819460016975897*^9, 3.8194600311508083`*^9}, {3.819546514399935*^9, 
  3.8195465257990923`*^9}},ExpressionUUID->"9596c99d-e3bd-4010-96c4-\
3050669841e3"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"27dbbdd0-5ca2-4e15-acb6-1d20e50544b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fisher", "[", 
   RowBox[{"fun_", ",", "pars_"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"fun", ",", "pars"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"pars", ",", "2"}], "}"}]}], "]"}]}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"bcd8a88e-0ab0-4759-9e69-2726de8ec8d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"H2", " ", "=", " ", 
    FractionBox[
     RowBox[{"a", " ", "\[CapitalNu]", " ", "P", " ", "T"}], 
     RowBox[{"1", "+", 
      RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}]]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.794825470827444*^9, 3.7948254711137857`*^9}, {
   3.7948260391962433`*^9, 3.794826043314506*^9}, {3.795369050655654*^9, 
   3.795369095388669*^9}, {3.795369526262475*^9, 3.7953695796482487`*^9}, {
   3.7953696559138517`*^9, 3.7953696627718267`*^9}, {3.7953700890594673`*^9, 
   3.795370090700048*^9}, 3.819034351759907*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"86cb9e20-0b32-4f06-a232-3b5b9276a767"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PoislL", "[", "func_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "n"}], " ", "func"}], "+", 
    RowBox[{
     RowBox[{"Log", "[", "func", "]"}], " ", "x"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"n", "\[Rule]", "1"}], "}"}]}]}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"a2c78ed5-5382-4a55-8e70-e9934514d221"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"subs", "=", 
   RowBox[{"{", 
    RowBox[{"T", "\[Rule]", " ", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalNu]vals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Fibonacci", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "8", ",", "15"}], "}"}]}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pvals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Fibonacci", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "3"}], "}"}]}], "]"}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalNu]probs", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Length", "[", "\[CapitalNu]vals", "]"}]}], ",", 
     RowBox[{"Length", "[", "\[CapitalNu]vals", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalNu]DistE", "=", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"\[CapitalNu]probs", "\[Rule]", "\[CapitalNu]vals"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pprobs", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Length", "[", "Pvals", "]"}]}], ",", 
     RowBox[{"Length", "[", "Pvals", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PDistE", "=", 
   RowBox[{"EmpiricalDistribution", "[", 
    RowBox[{"Pprobs", "\[Rule]", "Pvals"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.794611716982256*^9, 3.794611729972938*^9}, 
   3.7946117975463142`*^9, {3.7946118631055717`*^9, 3.794611946764764*^9}, 
   3.794612052953857*^9, 3.7946120956471148`*^9, {3.7946121480855303`*^9, 
   3.794612149956913*^9}, {3.794617520053903*^9, 3.794617524653204*^9}, 
   3.7946189313845*^9, 3.794621165265883*^9, {3.794654869460506*^9, 
   3.7946548719467583`*^9}, {3.794685919440933*^9, 3.7946859208476686`*^9}, {
   3.794791402501974*^9, 3.79479143706672*^9}, {3.794825482314714*^9, 
   3.794825483433094*^9}, {3.7948259802313766`*^9, 3.7948259832367773`*^9}, {
   3.795367941945456*^9, 3.7953679465381527`*^9}, {3.8167136650563383`*^9, 
   3.816713737805353*^9}, {3.8167139419416857`*^9, 3.8167139437241163`*^9}, {
   3.816715381823036*^9, 3.816715382118039*^9}, {3.8192457841057777`*^9, 
   3.8192457852249804`*^9}, {3.819245824136138*^9, 3.819245825687289*^9}, 
   3.81945896440556*^9, {3.819459017170611*^9, 3.8194590239171867`*^9}, {
   3.8194590876564417`*^9, 3.819459106647306*^9}, {3.819459484940583*^9, 
   3.8194594852910013`*^9}, {3.819459908684679*^9, 3.8194599180597687`*^9}, {
   3.819505505777603*^9, 3.81950550817703*^9}, {3.819545059650094*^9, 
   3.8195450597694483`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"5c2a8190-217d-4627-86a2-e0c2ee433cfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "21", ",", "34", ",", "55", ",", "89", ",", "144", ",", "233", ",", "377", 
   ",", "610"}], "}"}]], "Output",
 CellChangeTimes->{{3.8167136862364063`*^9, 3.8167137543877974`*^9}, 
   3.8167139442326803`*^9, 3.816714074112813*^9, 3.816714644863131*^9, 
   3.816715383176765*^9, 3.816720128619254*^9, 3.816722380821954*^9, 
   3.8169060126414223`*^9, 3.817038206850388*^9, 3.817045351990245*^9, 
   3.817212300663403*^9, {3.817227359858721*^9, 3.817227376910652*^9}, 
   3.817327969018147*^9, 3.817328085504972*^9, 3.819034045282241*^9, 
   3.81903429036727*^9, 3.819034465736311*^9, 3.819245001359844*^9, 
   3.819245324569112*^9, 3.819245785779152*^9, 3.819245826039867*^9, {
   3.8194590951510687`*^9, 3.819459107211136*^9}, 3.8194591524966927`*^9, 
   3.819459185442388*^9, 3.819459491002202*^9, 3.819459651606135*^9, {
   3.819459909887397*^9, 3.81945992462961*^9}, 3.819463139110059*^9, 
   3.819463229038927*^9, 3.819479160242285*^9, 3.819487476145938*^9, {
   3.819505506146792*^9, 3.819505516889484*^9}, 3.8195064292161818`*^9, 
   3.8195450603634*^9, 3.819545451835157*^9, 3.819546632090683*^9, 
   3.8195468633935223`*^9, 3.819546985157209*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"747af101-cca9-4ec9-ad04-bb7292582c3a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.8167136862364063`*^9, 3.8167137543877974`*^9}, 
   3.8167139442326803`*^9, 3.816714074112813*^9, 3.816714644863131*^9, 
   3.816715383176765*^9, 3.816720128619254*^9, 3.816722380821954*^9, 
   3.8169060126414223`*^9, 3.817038206850388*^9, 3.817045351990245*^9, 
   3.817212300663403*^9, {3.817227359858721*^9, 3.817227376910652*^9}, 
   3.817327969018147*^9, 3.817328085504972*^9, 3.819034045282241*^9, 
   3.81903429036727*^9, 3.819034465736311*^9, 3.819245001359844*^9, 
   3.819245324569112*^9, 3.819245785779152*^9, 3.819245826039867*^9, {
   3.8194590951510687`*^9, 3.819459107211136*^9}, 3.8194591524966927`*^9, 
   3.819459185442388*^9, 3.819459491002202*^9, 3.819459651606135*^9, {
   3.819459909887397*^9, 3.81945992462961*^9}, 3.819463139110059*^9, 
   3.819463229038927*^9, 3.819479160242285*^9, 3.819487476145938*^9, {
   3.819505506146792*^9, 3.819505516889484*^9}, 3.8195064292161818`*^9, 
   3.8195450603634*^9, 3.819545451835157*^9, 3.819546632090683*^9, 
   3.8195468633935223`*^9, 3.819546985158585*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"d14aee65-9c8a-49ab-b3ad-ff1eee73209c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EFisher", "[", 
   RowBox[{
   "FisherMatrix_", ",", "func_", ",", "PDistE_", ",", "\[CapitalNu]DistE_"}],
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Expectation", "[", "\[IndentingNewLine]", 
     RowBox[{"FisherMatrix", ",", "\[IndentingNewLine]", 
      RowBox[{"x", "\[Distributed]", " ", 
       RowBox[{"PoissonDistribution", "[", "func", "]"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P", "\[Distributed]", "PDistE"}], ",", " ", 
      RowBox[{"\[CapitalNu]", "\[Distributed]", "\[CapitalNu]DistE"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7946662553146563`*^9, 3.794666256848543*^9}, {
   3.794681355696546*^9, 3.7946813961259604`*^9}, {3.7946814664217863`*^9, 
   3.794681490002152*^9}, 3.794683050767548*^9, {3.794685603053419*^9, 
   3.794685614444615*^9}, {3.794685664651272*^9, 3.7946856666492853`*^9}, 
   3.794685770229308*^9, {3.794685914426292*^9, 3.7946859295435047`*^9}, {
   3.794685996262475*^9, 3.7946860418029613`*^9}, {3.794782740580328*^9, 
   3.79478274470649*^9}, {3.795378311346442*^9, 3.7953783178083477`*^9}, {
   3.816713763708227*^9, 3.816713766514886*^9}, {3.81924524461482*^9, 
   3.8192452548061743`*^9}, {3.81945887121681*^9, 3.819458872103119*^9}, {
   3.8194589061782713`*^9, 3.819458914113421*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"d8ccf395-1208-4930-be95-62e18461b3ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EFisherBoole", "[", 
   RowBox[{
   "FisherMatrix_", ",", "func_", ",", "PDistE_", ",", "\[CapitalNu]DistE_", 
    ",", "\[Lambda]min_", ",", "\[Lambda]max_", ",", "subs_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Expectation", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Expectation", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Boole", "[", 
         RowBox[{
         "\[Lambda]min", " ", "\[LessEqual]", " ", "func", "\[LessEqual]", 
          "\[Lambda]max"}], "]"}], "FisherMatrix"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Use", " ", "Boole", " ", "to", " ", "truncate", " ", "parameter", 
         " ", "range"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x", "\[Distributed]", " ", 
        RowBox[{"PoissonDistribution", "[", "func", "]"}]}]}], "]"}], "//.", 
     "subs"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P", "\[Distributed]", "PDistE"}], ",", " ", 
      RowBox[{"\[CapitalNu]", "\[Distributed]", "\[CapitalNu]DistE"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.799352029734478*^9, 3.799352060363348*^9}, {
   3.7993643765944853`*^9, 3.799364388850401*^9}, {3.799367757003655*^9, 
   3.799367758640464*^9}, 3.79936781721885*^9, {3.79936995305121*^9, 
   3.799369968150543*^9}, {3.7993702133589973`*^9, 3.7993702238356037`*^9}, {
   3.7993703322560577`*^9, 3.799370334127527*^9}, 3.7993704408481293`*^9, {
   3.799370853971732*^9, 3.7993708964461937`*^9}, {3.799373588158588*^9, 
   3.799373591081463*^9}, {3.799373633363927*^9, 3.7993736651273603`*^9}, {
   3.799373710559787*^9, 3.7993737158812733`*^9}, {3.799373777779948*^9, 
   3.79937378115476*^9}, {3.79937388330893*^9, 3.799373889754487*^9}, {
   3.799373983991973*^9, 3.799374003733822*^9}, {3.8004001621001253`*^9, 
   3.8004001808399067`*^9}, 3.800400226830505*^9, {3.800400414127371*^9, 
   3.800400422447003*^9}, {3.800400685574242*^9, 3.800400698716653*^9}, 
   3.8004071573890047`*^9, 3.8004073944104853`*^9, {3.8154775520895576`*^9, 
   3.815477552823653*^9}, {3.8172405835227623`*^9, 3.817240588554824*^9}, {
   3.817241189355308*^9, 3.8172411935631866`*^9}, {3.8172416238282146`*^9, 
   3.817241626979434*^9}, {3.817241665146167*^9, 3.8172416661055937`*^9}, {
   3.817242825396042*^9, 3.8172428305069427`*^9}, 3.8190338270776873`*^9, {
   3.819033927006628*^9, 3.819033927213951*^9}, {3.819245240823021*^9, 
   3.819245242862287*^9}, {3.819245308284864*^9, 3.819245309275709*^9}, {
   3.819245370618169*^9, 3.81924537456921*^9}, {3.81945892908936*^9, 
   3.819458949732586*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"71443fc1-dfff-42ba-8c17-20258482a885"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lLH2Poiss", "[", 
   RowBox[{"a_", ",", "h_"}], "]"}], ":=", 
  RowBox[{"PoislL", "[", "H2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FisherH2Poiss", "=", 
   RowBox[{"fisher", "[", 
    RowBox[{"lLH2Poiss", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "h"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.793468403408154*^9, 3.793468410679329*^9}, {
   3.793468453833345*^9, 3.7934685279957123`*^9}, {3.793468613919973*^9, 
   3.793468720737849*^9}, {3.7934688435224648`*^9, 3.793468868544662*^9}, {
   3.793470021800777*^9, 3.793470047198544*^9}, {3.79347027592621*^9, 
   3.7934702761653423`*^9}, {3.7940620589975843`*^9, 3.794062072794828*^9}, {
   3.794062321996887*^9, 3.7940623390179253`*^9}, {3.7940674750749207`*^9, 
   3.7940675715566063`*^9}, {3.794067618404457*^9, 3.794067643537713*^9}, 
   3.794068749489936*^9, 3.7940687842246943`*^9, {3.794074851177058*^9, 
   3.794074867069866*^9}, {3.794089226167008*^9, 3.794089227644266*^9}, {
   3.794165000037505*^9, 3.794165004570961*^9}, 3.7941650704419823`*^9, 
   3.7941659308887453`*^9, {3.794612260259066*^9, 3.7946122623453712`*^9}, {
   3.8192439805911303`*^9, 3.819243981118019*^9}, {3.819459299602044*^9, 
   3.819459306577423*^9}, {3.819546458730541*^9, 3.8195464837528057`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"49d1ef0a-460c-4bd8-9f5d-d17ee8ff26a4"],

Cell[CellGroupData[{

Cell["Determinants (Try out different limits )", "Subsection",
 CellChangeTimes->{{3.819546487273377*^9, 
  3.8195464993027687`*^9}},ExpressionUUID->"a6bbf1a0-6362-4629-8eb6-\
81eca3739222"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DetH2", "=", 
    RowBox[{"Det", "[", 
     RowBox[{"EFisher", "[", 
      RowBox[{
       RowBox[{"FisherH2Poiss", "/.", "subs"}], ",", 
       RowBox[{"H2", "/.", "subs"}], ",", "PDistE", ",", 
       "\[CapitalNu]DistE"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DetH2Ba", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"EFisherBoole", "[", 
     RowBox[{
     "FisherH2Poiss", ",", "H2", ",", "PDistE", ",", "\[CapitalNu]DistE", ",",
       "0", ",", "Infinity", ",", "subs"}], "]"}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", "limits"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"DetH2Bb", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"EFisherBoole", "[", 
     RowBox[{
     "FisherH2Poiss", ",", "H2", ",", "PDistE", ",", "\[CapitalNu]DistE", ",",
       "0", ",", 
      RowBox[{"Max", "[", "\[CapitalNu]vals", "]"}], ",", "subs"}], "]"}], 
    "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", "limits"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"DetH2Bc", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"EFisherBoole", "[", 
     RowBox[{
     "FisherH2Poiss", ",", "H2", ",", "PDistE", ",", "\[CapitalNu]DistE", ",",
       "1", ",", 
      RowBox[{"Max", "[", "\[CapitalNu]vals", "]"}], ",", "subs"}], "]"}], 
    "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", "limits"}], " ", "*)"}]}]}], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"47874357-b1fe-4f19-9f9b-ebd5e568e8e9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integration using Boole", "Section",
 CellChangeTimes->{{3.8190341112319317`*^9, 3.819034116366494*^9}, {
  3.819546320175496*^9, 
  3.819546322175064*^9}},ExpressionUUID->"f993afbd-997f-4b64-8c4a-\
06a6bef9ac56"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ParmRange", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", "1000"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"h", ",", "0", ",", "1000"}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"accgoal", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precgoal", "=", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NIntH2", "=", 
   RowBox[{"Log", "[", 
    RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", "DetH2", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ParmRange", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"ParmRange", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AccuracyGoal", "\[Rule]", "accgoal"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PrecisionGoal", "\[Rule]", "precgoal"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NIntH2Ba", "=", 
   RowBox[{"Log", "[", 
    RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", "DetH2Ba", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ParmRange", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"ParmRange", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AccuracyGoal", "\[Rule]", "accgoal"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PrecisionGoal", "\[Rule]", "precgoal"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NIntH2Bb", "=", 
   RowBox[{"Log", "[", 
    RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sqrt", "[", "DetH2Bb", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ParmRange", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"ParmRange", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AccuracyGoal", "\[Rule]", "accgoal"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PrecisionGoal", "\[Rule]", "precgoal"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"NIntH2Bc", "=", 
  RowBox[{"Log", "[", 
   RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Sqrt", "[", "DetH2Bc", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ParmRange", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"ParmRange", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AccuracyGoal", "\[Rule]", "accgoal"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PrecisionGoal", "\[Rule]", "precgoal"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.794829076160129*^9, 3.794829104949127*^9}, {
   3.794842651432555*^9, 3.794842669503619*^9}, {3.795297552392632*^9, 
   3.795297552857749*^9}, {3.7953012928637238`*^9, 3.7953012945344276`*^9}, {
   3.7953013359699993`*^9, 3.795301339848827*^9}, {3.795301400773859*^9, 
   3.79530141241613*^9}, 3.795306870730063*^9, {3.7953678724972878`*^9, 
   3.7953678838029757`*^9}, {3.795368026443605*^9, 3.795368056852985*^9}, {
   3.795371240503172*^9, 3.795371298076762*^9}, {3.79537133445124*^9, 
   3.7953713707144547`*^9}, {3.795371401157126*^9, 3.795371431856409*^9}, 
   3.795371805973138*^9, {3.795371941408825*^9, 3.7953719694978123`*^9}, {
   3.795372697801695*^9, 3.79537272269589*^9}, {3.795373008682906*^9, 
   3.79537303753653*^9}, {3.795377465420547*^9, 3.7953774927394753`*^9}, {
   3.8167144003733892`*^9, 3.816714400686504*^9}, {3.8167146615468807`*^9, 
   3.816714681065214*^9}, {3.8172149193327847`*^9, 3.817214985466393*^9}, {
   3.817258615242071*^9, 3.817258616881679*^9}, {3.819034373735036*^9, 
   3.819034395565558*^9}, {3.819034459195342*^9, 3.8190344610908833`*^9}, 
   3.8192450315824537`*^9, {3.819245103500181*^9, 3.8192451455782623`*^9}, {
   3.819245599513145*^9, 3.8192456285675507`*^9}, {3.819245754502681*^9, 
   3.819245759634324*^9}, {3.8194596442476597`*^9, 3.819459645454225*^9}, {
   3.819459805802176*^9, 3.8194598713137617`*^9}, {3.8194599396758423`*^9, 
   3.819459940411354*^9}, 3.8195464009898853`*^9, {3.819546431579481*^9, 
   3.819546441730699*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"98a2fe9b-2c33-49fc-b310-57cfdf247f06"],

Cell[BoxData["11.6372515976039`"], "Output",
 CellChangeTimes->{{3.819245048533309*^9, 3.819245148160734*^9}, 
   3.819245324992324*^9, 3.8192455821460743`*^9, 3.819245629353689*^9, {
   3.8192456686460667`*^9, 3.81924569365366*^9}, 3.8192457667366*^9, 
   3.819245800242445*^9, 3.819245831704507*^9, {3.819459138967967*^9, 
   3.819459152776826*^9}, 3.819459185600518*^9, 3.81945934607014*^9, 
   3.8194594911682367`*^9, 3.8194596517653913`*^9, 3.819459821365492*^9, {
   3.819459851596642*^9, 3.819459872284978*^9}, {3.819459924834008*^9, 
   3.819459941520576*^9}, 3.8194631399815207`*^9, 3.819463229232588*^9, 
   3.819479161919278*^9, 3.819487476993794*^9, 3.8195064294138737`*^9, 
   3.819545074269153*^9, 3.8195454535557203`*^9, 3.8195466322703457`*^9, 
   3.819546864057642*^9, 3.8195469856883497`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"f7a86386-28be-429c-b986-d936d12b1bf9"],

Cell[BoxData["11.6372515976039`"], "Output",
 CellChangeTimes->{{3.819245048533309*^9, 3.819245148160734*^9}, 
   3.819245324992324*^9, 3.8192455821460743`*^9, 3.819245629353689*^9, {
   3.8192456686460667`*^9, 3.81924569365366*^9}, 3.8192457667366*^9, 
   3.819245800242445*^9, 3.819245831704507*^9, {3.819459138967967*^9, 
   3.819459152776826*^9}, 3.819459185600518*^9, 3.81945934607014*^9, 
   3.8194594911682367`*^9, 3.8194596517653913`*^9, 3.819459821365492*^9, {
   3.819459851596642*^9, 3.819459872284978*^9}, {3.819459924834008*^9, 
   3.819459941520576*^9}, 3.8194631399815207`*^9, 3.819463229232588*^9, 
   3.819479161919278*^9, 3.819487476993794*^9, 3.8195064294138737`*^9, 
   3.819545074269153*^9, 3.8195454535557203`*^9, 3.8195466322703457`*^9, 
   3.819546864057642*^9, 3.819546985901101*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"69b24ae1-fe77-44a2-b390-bbfe1532ffd7"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", 2, 25, 3, 31195811581613014776, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.819459877442224*^9, {3.8194599300238667`*^9, 3.819459946718214*^9}, 
   3.81946314522878*^9, 3.819463234415896*^9, 3.819479167234726*^9, 
   3.819487482254408*^9, 3.819506434594634*^9, 3.819545079508106*^9, 
   3.81954545892944*^9, 3.8195466374942303`*^9, 3.819546869306332*^9, 
   3.819546990936102*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"b9306c45-79dd-4d59-90a8-73f770ba04ae"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "eincr", 
   "\"The global error of the strategy GlobalAdaptive has increased more than \
\\!\\(\\*RowBox[{\\\"2000\\\"}]\\) times. The global error is expected to \
decrease monotonically after a number of integrand evaluations. Suspect one \
of the following: the working precision is insufficient for the specified \
precision goal; the integrand is highly oscillatory or it is not a \
(piecewise) smooth function; or the true value of the integral is 0. \
Increasing the value of the GlobalAdaptive option MaxErrorIncreases might \
lead to a convergent numerical integration. NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"537.6732213856587`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.5182875768400887`\\\"}]\\) for the integral and error \
estimates.\"", 2, 25, 4, 31195811581613014776, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.819459877442224*^9, {3.8194599300238667`*^9, 3.819459946718214*^9}, 
   3.81946314522878*^9, 3.819463234415896*^9, 3.819479167234726*^9, 
   3.819487482254408*^9, 3.819506434594634*^9, 3.819545079508106*^9, 
   3.81954545892944*^9, 3.8195466374942303`*^9, 3.819546869306332*^9, 
   3.819546992416206*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"2ff7d95c-fd65-4a6d-916b-fde72c2167e2"],

Cell[BoxData["6.287250980428651`"], "Output",
 CellChangeTimes->{{3.819245048533309*^9, 3.819245148160734*^9}, 
   3.819245324992324*^9, 3.8192455821460743`*^9, 3.819245629353689*^9, {
   3.8192456686460667`*^9, 3.81924569365366*^9}, 3.8192457667366*^9, 
   3.819245800242445*^9, 3.819245831704507*^9, {3.819459138967967*^9, 
   3.819459152776826*^9}, 3.819459185600518*^9, 3.81945934607014*^9, 
   3.8194594911682367`*^9, 3.8194596517653913`*^9, 3.819459821365492*^9, {
   3.819459851596642*^9, 3.819459872284978*^9}, {3.819459924834008*^9, 
   3.819459941520576*^9}, 3.8194631399815207`*^9, 3.819463229232588*^9, 
   3.819479161919278*^9, 3.819487476993794*^9, 3.8195064294138737`*^9, 
   3.819545074269153*^9, 3.8195454535557203`*^9, 3.8195466322703457`*^9, 
   3.819546864057642*^9, 3.819546992443192*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"efe42a66-4538-41c0-8818-f7515222fc26"],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{{3.819245048533309*^9, 3.819245148160734*^9}, 
   3.819245324992324*^9, 3.8192455821460743`*^9, 3.819245629353689*^9, {
   3.8192456686460667`*^9, 3.81924569365366*^9}, 3.8192457667366*^9, 
   3.819245800242445*^9, 3.819245831704507*^9, {3.819459138967967*^9, 
   3.819459152776826*^9}, 3.819459185600518*^9, 3.81945934607014*^9, 
   3.8194594911682367`*^9, 3.8194596517653913`*^9, 3.819459821365492*^9, {
   3.819459851596642*^9, 3.819459872284978*^9}, {3.819459924834008*^9, 
   3.819459941520576*^9}, 3.8194631399815207`*^9, 3.819463229232588*^9, 
   3.819479161919278*^9, 3.819487476993794*^9, 3.8195064294138737`*^9, 
   3.819545074269153*^9, 3.8195454535557203`*^9, 3.8195466322703457`*^9, 
   3.819546864057642*^9, 3.8195469974618797`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"0c8c28f8-a458-413d-9060-2d1b7d06ac9c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using ImplicitRegion instead of Boole", "Section",
 CellChangeTimes->{{3.81954630438501*^9, 
  3.819546314138545*^9}},ExpressionUUID->"5cba26e5-eb7c-477d-9368-\
28316db37c43"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImplRegion", "[", 
    RowBox[{
    "func_", ",", "params_", ",", "amin_", ",", "amax_", ",", "Fmin_", ",", 
     "Fmax_", ",", "\[CapitalNu]vals_", ",", "Pvals_", ",", "subs_"}], "]"}], 
   ":=", "\[IndentingNewLine]", 
   RowBox[{"ImplicitRegion", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Fmin", "\[LessEqual]", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"func", "/.", "subs"}], "/.", 
          RowBox[{"P", "\[Rule]", " ", "Pvals"}]}], "/.", 
         RowBox[{"\[CapitalNu]", "\[Rule]", " ", "\[CapitalNu]vals"}]}], 
        "]"}]}], "&&", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"func", "/.", "subs"}], "/.", 
          RowBox[{"P", "\[Rule]", " ", "Pvals"}]}], "/.", 
         RowBox[{"\[CapitalNu]", "\[Rule]", " ", "\[CapitalNu]vals"}]}], 
        "]"}], "\[LessEqual]", "Fmax"}], "&&", " ", "\[IndentingNewLine]", 
      RowBox[{
      "amin", " ", "\[LessEqual]", " ", "a", " ", "\[LessEqual]", " ", 
       "amax"}]}], ",", "\[IndentingNewLine]", "params"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.819461471805376*^9, 3.819461473034696*^9}, {
  3.8194615296169033`*^9, 3.819461542151916*^9}, {3.819461601502448*^9, 
  3.819461618485961*^9}, {3.8195054374209747`*^9, 3.81950546937807*^9}, {
  3.819505536055468*^9, 3.819505572822345*^9}, {3.8195056997056293`*^9, 
  3.8195057924532623`*^9}, {3.819506004485507*^9, 3.819506004752325*^9}, {
  3.819506184407754*^9, 3.8195062592592983`*^9}, {3.8195064150160017`*^9, 
  3.819506418584291*^9}, {3.819544993021278*^9, 3.819545007763546*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"768bd98c-b0fd-492b-9b66-5402363899a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[ScriptCapitalR]", "=", 
  RowBox[{"ImplRegion", "[", 
   RowBox[{"H2", ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "h"}], "}"}], ",", "0", ",", "1000", ",", "0", ",", 
    RowBox[{"Max", "[", "\[CapitalNu]vals", "]"}], ",", "\[CapitalNu]vals", 
    ",", "Pvals", ",", "subs"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.819505947287272*^9, 3.819505981629621*^9}, {
  3.8195062746516027`*^9, 3.819506284378749*^9}, {3.819506421893424*^9, 
  3.819506424132908*^9}, {3.819545012212028*^9, 3.8195450151394567`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"0606740e-9e04-4d95-8c97-a705533c50a8"],

Cell[BoxData[
 RowBox[{"ImplicitRegion", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"0", "\[LessEqual]", 
     RowBox[{"Min", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"21", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"21", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"42", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"21", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"34", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"34", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"68", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"34", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"55", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"55", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"110", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"55", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"89", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"89", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"178", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"89", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"144", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"144", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"288", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"144", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"233", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"233", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"466", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"233", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"377", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"377", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"754", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"377", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"610", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"610", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"1220", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"610", " ", "a", " ", "h"}]}]]}], "]"}]}], "&&", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"21", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"21", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"42", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"21", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"34", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"34", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"68", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"34", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"55", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"55", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"110", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"55", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"89", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"89", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"178", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"89", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"144", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"144", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"288", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"144", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"233", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"233", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"466", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"233", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"377", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"377", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"754", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"377", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"610", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"610", " ", "a", " ", "h"}]}]], ",", 
       FractionBox[
        RowBox[{"1220", " ", "a"}], 
        RowBox[{"1", "+", 
         RowBox[{"610", " ", "a", " ", "h"}]}]]}], "]"}], "\[LessEqual]", 
     "610"}], "&&", 
    RowBox[{"0", "\[LessEqual]", "a", "\[LessEqual]", "1000"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "h"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.819505982845792*^9, 3.8195060078707733`*^9}, 
   3.819506333145934*^9, 3.8195064408947*^9, 3.819545019278368*^9, 
   3.819545093484757*^9, 3.819545465693012*^9, 3.8195466440798187`*^9, 
   3.8195468759462442`*^9, 3.819546964887928*^9, 3.8195469975571747`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"4902c1ec-f47f-4442-a626-3778fca0d158"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{"Log", "[", "\[IndentingNewLine]", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "DetH2", "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "h"}], "}"}], "\[Element]", "\[ScriptCapitalR]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"AccuracyGoal", "\[Rule]", "accgoal"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PrecisionGoal", "\[Rule]", "precgoal"}]}], "]"}], "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.818965877234764*^9, 3.818965877236164*^9}, {
   3.818987333809347*^9, 3.818987334135559*^9}, 3.819460348021484*^9, {
   3.8194604001950893`*^9, 3.819460404642084*^9}, 3.819460479916109*^9, {
   3.819460673477867*^9, 3.819460720982745*^9}, {3.819460756222762*^9, 
   3.819460809435459*^9}, {3.819460846205276*^9, 3.819460865867008*^9}, {
   3.819460999106722*^9, 3.8194610072049522`*^9}, {3.819461200909772*^9, 
   3.819461202796913*^9}, {3.8194613297375383`*^9, 3.819461380134307*^9}, {
   3.819461411453946*^9, 3.8194614400488997`*^9}, {3.819461604366662*^9, 
   3.819461609901585*^9}, {3.819461911083124*^9, 3.819461932074032*^9}, {
   3.8194621356344767`*^9, 3.819462135889511*^9}, {3.819462340487575*^9, 
   3.8194623477184477`*^9}, {3.8194623983325577`*^9, 3.819462407492429*^9}, {
   3.819462686929577*^9, 3.819462700972629*^9}, 3.819462739760045*^9, 
   3.8194632568036203`*^9, {3.819506286954204*^9, 3.8195062872372*^9}, {
   3.8195445852929497`*^9, 3.819544589892119*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"00fab7a7-a521-470d-87a8-eb067e88c2a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.446736`", ",", "5.392125238871446`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.818987344114646*^9, 3.8190342885672827`*^9, 3.819034463932252*^9, 
   3.819245321745914*^9, 3.819459150601015*^9, 3.819459183559514*^9, 
   3.819459489076953*^9, 3.819459649707699*^9, 3.819459922696576*^9, 
   3.8194604059095173`*^9, 3.819460707031869*^9, 3.819460757360626*^9, 
   3.819460791324176*^9, {3.8194608493718157`*^9, 3.819460866255376*^9}, 
   3.8194610108103323`*^9, 3.819461210272478*^9, {3.819461330349104*^9, 
   3.819461334604525*^9}, {3.819461364838697*^9, 3.819461380644862*^9}, 
   3.819461412584247*^9, 3.819461544969545*^9, 3.8194616338979893`*^9, 
   3.819461929564115*^9, 3.8194621280817833`*^9, 3.819462161915884*^9, 
   3.819462361451827*^9, 3.819462684600099*^9, 3.8194630488696012`*^9, 
   3.819463093036014*^9, 3.8194631675141373`*^9, 3.819463224386341*^9, 
   3.819469589753249*^9, 3.819487571894396*^9, 3.819506104941896*^9, 
   3.819506410938733*^9, 3.819506520770411*^9, 3.819544676996566*^9, 
   3.819545479037045*^9, 3.81954665652829*^9, 3.81954688889001*^9, 
   3.8195470103101387`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"93e63526-ef07-49e5-8433-cb036dcc25eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", "\[IndentingNewLine]", 
  RowBox[{"Log", "[", "\[IndentingNewLine]", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"Sqrt", "[", "DetH2", "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "h"}], "}"}], "\[Element]", 
      RowBox[{"DiscretizeRegion", "[", 
       RowBox[{"\[ScriptCapitalR]", ",", " ", 
        RowBox[{"AccuracyGoal", "\[Rule]", "accgoal"}], ",", " ", 
        RowBox[{"PrecisionGoal", "\[Rule]", "precgoal"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AccuracyGoal", "\[Rule]", "accgoal"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PrecisionGoal", "\[Rule]", "precgoal"}]}], "]"}], "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.818965877234764*^9, 3.818965877236164*^9}, {
   3.818987333809347*^9, 3.818987334135559*^9}, 3.819460348021484*^9, {
   3.8194604001950893`*^9, 3.819460404642084*^9}, 3.819460479916109*^9, {
   3.819460673477867*^9, 3.819460720982745*^9}, {3.819460756222762*^9, 
   3.819460809435459*^9}, {3.819460846205276*^9, 3.819460865867008*^9}, {
   3.819460999106722*^9, 3.8194610072049522`*^9}, {3.819461200909772*^9, 
   3.819461202796913*^9}, {3.8194613297375383`*^9, 3.819461380134307*^9}, {
   3.819461411453946*^9, 3.8194614400488997`*^9}, {3.819461604366662*^9, 
   3.819461609901585*^9}, {3.819461911083124*^9, 3.819461932074032*^9}, {
   3.8194621356344767`*^9, 3.819462135889511*^9}, {3.819462340487575*^9, 
   3.8194623477184477`*^9}, {3.8194623983325577`*^9, 3.819462407492429*^9}, {
   3.819462686929577*^9, 3.819462700972629*^9}, 3.819462739760045*^9, 
   3.8194632568036203`*^9, {3.819506286954204*^9, 3.8195062872372*^9}, {
   3.8195418345312862`*^9, 3.8195418363268423`*^9}, {3.8195445913564863`*^9, 
   3.8195445937636223`*^9}, {3.819545745559424*^9, 3.819545745777266*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"b9d3266c-01ae-4592-bff0-1ec1b7b200a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11.131055`", ",", "5.392125238871446`"}], "}"}]], "Output",
 CellChangeTimes->{3.819541951995532*^9, 3.819544749957054*^9, 
  3.8195454863214703`*^9, 3.819545754002882*^9, 3.819546630115375*^9, 
  3.8195468601749773`*^9, 3.819546972354108*^9, 3.8195470174455357`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"43d31ee5-9f99-4b90-b7b0-675a72bfdce9"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1194, 1347},
WindowMargins->{{Automatic, 588}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3ba8297f-25a4-4b9e-b384-ed9c4ce8212b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 282, 4, 84, "Section",ExpressionUUID->"9596c99d-e3bd-4010-96c4-3050669841e3"],
Cell[865, 28, 151, 2, 37, "Input",ExpressionUUID->"27dbbdd0-5ca2-4e15-acb6-1d20e50544b8"],
Cell[1019, 32, 387, 11, 37, "Input",ExpressionUUID->"bcd8a88e-0ab0-4759-9e69-2726de8ec8d0"],
Cell[1409, 45, 696, 14, 86, "Input",ExpressionUUID->"86cb9e20-0b32-4f06-a232-3b5b9276a767"],
Cell[2108, 61, 378, 11, 37, "Input",ExpressionUUID->"a2c78ed5-5382-4a55-8e70-e9934514d221"],
Cell[CellGroupData[{
Cell[2511, 76, 2821, 63, 220, "Input",ExpressionUUID->"5c2a8190-217d-4627-86a2-e0c2ee433cfe"],
Cell[5335, 141, 1274, 20, 42, "Output",ExpressionUUID->"747af101-cca9-4ec9-ad04-bb7292582c3a"],
Cell[6612, 163, 1195, 18, 42, "Output",ExpressionUUID->"d14aee65-9c8a-49ab-b3ad-ff1eee73209c"]
}, Open  ]],
Cell[7822, 184, 1499, 28, 168, "Input",ExpressionUUID->"d8ccf395-1208-4930-be95-62e18461b3ae"],
Cell[9324, 214, 2737, 50, 168, "Input",ExpressionUUID->"71443fc1-dfff-42ba-8c17-20258482a885"],
Cell[12064, 266, 1395, 24, 64, "Input",ExpressionUUID->"49d1ef0a-460c-4bd8-9f5d-d17ee8ff26a4"],
Cell[CellGroupData[{
Cell[13484, 294, 190, 3, 67, "Subsection",ExpressionUUID->"a6bbf1a0-6362-4629-8eb6-81eca3739222"],
Cell[13677, 299, 1552, 40, 168, "Input",ExpressionUUID->"47874357-b1fe-4f19-9f9b-ebd5e568e8e9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15278, 345, 219, 4, 84, "Section",ExpressionUUID->"f993afbd-997f-4b64-8c4a-06a6bef9ac56"],
Cell[CellGroupData[{
Cell[15522, 353, 4534, 94, 844, "Input",ExpressionUUID->"98a2fe9b-2c33-49fc-b310-57cfdf247f06"],
Cell[20059, 449, 889, 12, 42, "Output",ExpressionUUID->"f7a86386-28be-429c-b986-d936d12b1bf9"],
Cell[20951, 463, 887, 12, 42, "Output",ExpressionUUID->"69b24ae1-fe77-44a2-b390-bbfe1532ffd7"],
Cell[21841, 477, 770, 16, 50, "Message",ExpressionUUID->"b9306c45-79dd-4d59-90a8-73f770ba04ae"],
Cell[22614, 495, 1312, 23, 113, "Message",ExpressionUUID->"2ff7d95c-fd65-4a6d-916b-fde72c2167e2"],
Cell[23929, 520, 888, 12, 42, "Output",ExpressionUUID->"efe42a66-4538-41c0-8818-f7515222fc26"],
Cell[24820, 534, 885, 12, 42, "Output",ExpressionUUID->"0c8c28f8-a458-413d-9060-2d1b7d06ac9c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25754, 552, 181, 3, 84, "Section",ExpressionUUID->"5cba26e5-eb7c-477d-9368-28316db37c43"],
Cell[25938, 557, 1799, 38, 194, "Input",ExpressionUUID->"768bd98c-b0fd-492b-9b66-5402363899a8"],
Cell[CellGroupData[{
Cell[27762, 599, 618, 11, 37, "Input",ExpressionUUID->"0606740e-9e04-4d95-8c97-a705533c50a8"],
Cell[28383, 612, 5147, 146, 230, "Output",ExpressionUUID->"4902c1ec-f47f-4442-a626-3778fca0d158"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33567, 763, 1629, 28, 168, "Input",ExpressionUUID->"00fab7a7-a521-470d-87a8-eb067e88c2a2"],
Cell[35199, 793, 1225, 19, 42, "Output",ExpressionUUID->"93e63526-ef07-49e5-8433-cb036dcc25eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36461, 817, 1932, 33, 168, "Input",ExpressionUUID->"b9d3266c-01ae-4592-bff0-1ec1b7b200a6"],
Cell[38396, 852, 386, 6, 42, "Output",ExpressionUUID->"43d31ee5-9f99-4b90-b7b0-675a72bfdce9"]
}, Open  ]]
}, Open  ]]
}
]
*)

